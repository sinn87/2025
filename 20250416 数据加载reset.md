## 2. UCR010 æ§ä»¶åŠ å±æ€§ï¼šä¿å­˜å½“å‰æ¨¡å¼
Private _mode As EntryMode
Public Property Mode As EntryMode
    Get
        Return _mode
    End Get
    Set(value As EntryMode)
        _mode = value
        ApplyModeSettings()  ' è‡ªåŠ¨å“åº”è®¾ç½®
    End Set
End Property

##  3. ç»Ÿä¸€åˆå§‹åŒ–å‡½æ•°ï¼ˆå¸¦ä¸»é”®ï¼‰
vbnet
å¤åˆ¶
ç¼–è¾‘
Public Sub Initialize(mode As EntryMode, Optional key As String = "")
    Me.Mode = mode

    Select Case mode
        Case EntryMode.ViewOnly
            LoadMainData(key)            ' ä¸‹è½½å†å²æ•°æ®
            DisableAllInputs()          ' è®¾ç½®æ§ä»¶ä¸ºä¸å¯ç¼–å†™
            ' ä¸è½½å…¥ ComboBoxï¼ˆè·³è¿‡ï¼‰

        Case EntryMode.CreateNew
            LoadComboBoxSources()       ' åªè½½å…¥é€‰é¡¹æ•°æ®
            SetDefaultValues()          ' å¦‚æ—¶é—´åˆå§‹å€¼ä¸ºä»Šå¤©
            EnableAllInputs()

        Case EntryMode.Edit
            LoadMainData(key)           ' ä¸‹è½½å†å²æ•°æ®
            LoadComboBoxSources()       ' åŠ è½½é€‰é¡¹
            EnableAllInputs()
    End Select
End Sub
## ğŸ”¹ 4. æ§ä»¶å¯ç”¨/ç¦ç”¨å‡½æ•°
vbnet
å¤åˆ¶
ç¼–è¾‘
Private Sub EnableAllInputs()
    For Each ctrl As Control In Me.Controls
        SetControlEditable(ctrl, True)
    Next
End Sub

Private Sub DisableAllInputs()
    For Each ctrl As Control In Me.Controls
        SetControlEditable(ctrl, False)
    Next
End Sub

Private Sub SetControlEditable(ctrl As Control, editable As Boolean)
    If TypeOf ctrl Is TextBox Then
        DirectCast(ctrl, TextBox).ReadOnly = Not editable

    ElseIf TypeOf ctrl Is ComboBox Then
        DirectCast(ctrl, ComboBox).Enabled = editable

    ElseIf TypeOf ctrl Is CheckBox Then
        DirectCast(ctrl, CheckBox).Enabled = editable

    ElseIf TypeOf ctrl Is DateTimePicker Then
        DirectCast(ctrl, DateTimePicker).Enabled = editable

    ElseIf ctrl.HasChildren Then
        ' é€’å½’å¤„ç†å­æ§ä»¶
        For Each subCtrl As Control In ctrl.Controls
            SetControlEditable(subCtrl, editable)
        Next
    End If
End Sub
## ğŸ”¹ 5. Load å‡½æ•°ç¤ºä¾‹ï¼ˆä½ å¯è‡ªå·±å†™ï¼‰
vbnet
å¤åˆ¶
ç¼–è¾‘
Private Sub LoadComboBoxSources()
    ' åŠ è½½ä¸‹æ‹‰æ¡†é€‰é¡¹ï¼Œå¦‚:
    cboStatus.Items.Clear()
    cboStatus.Items.AddRange(New String() {"å¾…å¤„ç†", "å¤„ç†ä¸­", "å·²å®Œæˆ"})
End Sub

Private Sub SetDefaultValues()
    dtpStart.Value = Date.Today
End Sub

Private Sub LoadMainData(key As String)
    ' ç”¨ key æŸ¥è¯¢æ•°æ®åº“ï¼Œå¡«å……æ§ä»¶ï¼ˆè°ƒç”¨ FillControlsFromDictï¼‰
End Sub
## âœ… ä½¿ç”¨æ–¹æ³•ï¼ˆå¤–éƒ¨è°ƒç”¨ï¼‰
vbnet
å¤åˆ¶
ç¼–è¾‘
ucr010.Initialize(EntryMode.Edit, "é¡¹ç›®ç¼–ç ABC")
