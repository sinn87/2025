‚úÖ Á§∫‰æã‰ª£Á†ÅÔºàÂú®‰Ω†ÁöÑ DgvUserControl ÂÜÖÂÆûÁé∞Ôºâ
üîπ 1. Ê∑ªÂä†Â±ûÊÄßÂà∞ UserControlÔºö
vbnet
Â§çÂà∂
ÁºñËæë
' ÊòØÂê¶ÂêØÁî®Ê†áÁ≠æÈ£éÊ†ºÊ∏≤Êüì
Public Property EnableLabelStyle As Boolean = False

' ÈúÄË¶ÅÂ∫îÁî®Ê†áÁ≠æÊ†∑ÂºèÁöÑÂàóÁ¥¢ÂºïÔºà‰ªé0ÂºÄÂßãÔºâÔºåÈªòËÆ§ÊòØÁ¨¨3Âàó
Public Property LabelColumnIndex As Integer = 2
üîπ 2. Âú®ÊûÑÈÄ†ÂáΩÊï∞Êàñ Load ‰∏≠ÁªëÂÆö CellPaintingÔºö
vbnet
Â§çÂà∂
ÁºñËæë
Private Sub DgvUserControl_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    AddHandler Me.DataGridView1.CellPainting, AddressOf OnDgvCellPainting
End Sub
üîπ 3. Ëá™ÂÆö‰πâ CellPaintingÔºå‰ªÖÂØπÂêØÁî®Ê†áÁ≠æÈ£éÊ†ºÁöÑÂàóÂ§ÑÁêÜÔºö
vbnet
Â§çÂà∂
ÁºñËæë
Private Sub OnDgvCellPainting(sender As Object, e As DataGridViewCellPaintingEventArgs)
    If Not EnableLabelStyle Then Return

    If e.RowIndex >= 0 AndAlso e.ColumnIndex = LabelColumnIndex Then
        e.Handled = True
        e.PaintBackground(e.CellBounds, True)

        Dim text As String = e.FormattedValue?.ToString()
        Dim backColor As Color = Color.LightGreen
        Dim textColor As Color = Color.Black

        Select Case text
            Case "ÂÆå‰∫Ü"
                backColor = Color.Gray
                textColor = Color.White
            Case "ÂºÇÂ∏∏"
                backColor = Color.IndianRed
                textColor = Color.White
            Case "Â§ÑÁêÜ‰∏≠"
                backColor = Color.SteelBlue
                textColor = Color.White
        End Select

        Dim rect As New Rectangle(e.CellBounds.X + 6, e.CellBounds.Y + 6,
                                  e.CellBounds.Width - 12, e.CellBounds.Height - 12)

        Dim radius As Integer = 10
        Dim path As New Drawing2D.GraphicsPath()
        path.AddArc(rect.Left, rect.Top, radius, radius, 180, 90)
        path.AddArc(rect.Right - radius, rect.Top, radius, radius, 270, 90)
        path.AddArc(rect.Right - radius, rect.Bottom - radius, radius, radius, 0, 90)
        path.AddArc(rect.Left, rect.Bottom - radius, radius, radius, 90, 90)
        path.CloseFigure()

        Using brush As New SolidBrush(backColor)
            e.Graphics.FillPath(brush, path)
        End Using

        Dim sf As New StringFormat With {
            .Alignment = StringAlignment.Center,
            .LineAlignment = StringAlignment.Center
        }

        Using textBrush As New SolidBrush(textColor)
            e.Graphics.DrawString(text, e.CellStyle.Font, textBrush, rect, sf)
        End Using
    End If
End Sub
‚úÖ ‰ΩøÁî®ÊñπÂºèÔºà‰∏ªÁ™ó‰ΩìÊàñÂÖ∂‰ªñÈ°µÈù¢Ë∞ÉÁî®ÔºâÔºö
vbnet
Â§çÂà∂
ÁºñËæë
YourUserControl.EnableLabelStyle = True
YourUserControl.LabelColumnIndex = 2
